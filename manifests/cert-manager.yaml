# @author Alejandro Galue <agalue@opennms.org>
#
# Warning: please use your own email and domains.
#          this is not intended to be used by any user.

---
apiVersion: certmanager.k8s.io/v1alpha1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
  namespace: opennms
  labels:
    deployment: drift
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: agalue@opennms.org
    privateKeySecretRef:
      name: letsencrypt-prod
    http01: {}

---
apiVersion: certmanager.k8s.io/v1alpha1
kind: Certificate
metadata:
  name: k8s-opennms-org
  namespace: opennms
  labels:
    deployment: drift
spec:
  secretName: k8s-opennms-org-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  commonName: k8s.opennms.org
  dnsNames:
    - k8s.opennms.org
    - grafana.k8s.opennms.org
    - hasura.k8s.opennms.org
    - kafka-manager.k8s.opennms.org
    - kibana.k8s.opennms.org
    - onms.k8s.opennms.org
    - onmsui.k8s.opennms.org
  acme:
    config:
      - http01:
          ingressClass: nginx
        domains:
          - k8s.opennms.org
          - grafana.k8s.opennms.org
          - hasura.k8s.opennms.org
          - kafka-manager.k8s.opennms.org
          - kibana.k8s.opennms.org
          - onms.k8s.opennms.org
          - onmsui.k8s.opennms.org
